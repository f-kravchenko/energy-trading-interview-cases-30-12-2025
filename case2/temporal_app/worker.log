INFO:__main__:Connected to Temporal server
INFO:__main__:Starting forecast worker on task queue: forecast-queue
INFO:__main__:Worker will process IntradayForecastWorkflow requests
INFO:__main__:Press Ctrl+C to stop
[2m2025-12-29T22:30:14.780042Z[0m [33m WARN[0m [2mtemporalio_sdk_core::worker::heartbeat[0m[2m:[0m Worker heartbeating configured for runtime, but server version does not support it.
INFO:temporalio.workflow:Starting forecast workflow for device 21231500202609620933056238N3 ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Starting forecast workflow for device 21232200202609620933097655N9 ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Starting forecast workflow for device 21183900202529220938026983N5 ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Validating request for device 21231500202609620933056238N3 ({'activity_id': '1', 'activity_type': 'validate_request', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Validation passed for device 21231500202609620933056238N3 ({'activity_id': '1', 'activity_type': 'validate_request', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Validating request for device 21232200202609620933097655N9 ({'activity_id': '1', 'activity_type': 'validate_request', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Validation passed for device 21232200202609620933097655N9 ({'activity_id': '1', 'activity_type': 'validate_request', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Validating request for device 21183900202529220938026983N5 ({'activity_id': '1', 'activity_type': 'validate_request', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Validation passed for device 21183900202529220938026983N5 ({'activity_id': '1', 'activity_type': 'validate_request', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Fetching historical data from ClickHouse ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Fetching historical data from ClickHouse ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Fetching historical data from ClickHouse ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Fetching historical data for 21231500202609620933056238N3 ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Cache MISS for 21231500202609620933056238N3, querying ClickHouse ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Retrieved 2856 rows with 28 columns from ClickHouse ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Fetched 672 rows for 21231500202609620933056238N3 (returning 672 cols) ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Fetching historical data for 21232200202609620933097655N9 ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Cache MISS for 21232200202609620933097655N9, querying ClickHouse ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Retrieved 2856 rows with 28 columns from ClickHouse ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Fetched 672 rows for 21232200202609620933097655N9 (returning 672 cols) ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Loading forecasting model ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Fetching historical data for 21183900202529220938026983N5 ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Cache MISS for 21183900202529220938026983N5, querying ClickHouse ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Retrieved 2856 rows with 28 columns from ClickHouse ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Fetched 672 rows for 21183900202529220938026983N5 (returning 672 cols) ({'activity_id': '2', 'activity_type': 'fetch_historical_data', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Loading forecasting model ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Loading model for 21231500202609620933056238N3 ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Loading model from Cloud Storage ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Model loaded and cached ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Generating forecast predictions ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Loading model for 21232200202609620933097655N9 ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Model found in worker memory ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Loading forecasting model ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Generating 6h forecast for 21231500202609620933056238N3 starting 2025-02-28 01:00:00+00:00 ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
/Users/fedor/Documents/projects/CV/hometasks/podero/case2/temporal_app/activities/forecast_activities.py:225: FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
  historical_df = pd.read_json(historical_data_json, orient='records')
INFO:temporalio.activity:Historical data loaded: 672 rows, 10 columns: ['serial_number', 'start', 'end', 'start_unix', 'end_unix', 'centralHeating.electricity', 'cooling.electricity', 'domesticHotWater.electricity', 'manufacturer', 'price_zone'] ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Forecast generated: 24 predictions, min=0.00, max=0.00, avg=0.00 Wh ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Generated 24 predictions, total 0.00 Wh ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Generating forecast predictions ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Loading model for 21183900202529220938026983N5 ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Model found in worker memory ({'activity_id': '3', 'activity_type': 'load_model_from_cache', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Publishing forecast to trading system ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Generating forecast predictions ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Generating 6h forecast for 21232200202609620933097655N9 starting 2025-02-28 01:00:00+00:00 ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
/Users/fedor/Documents/projects/CV/hometasks/podero/case2/temporal_app/activities/forecast_activities.py:225: FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
  historical_df = pd.read_json(historical_data_json, orient='records')
INFO:temporalio.activity:Historical data loaded: 672 rows, 10 columns: ['serial_number', 'start', 'end', 'start_unix', 'end_unix', 'centralHeating.electricity', 'cooling.electricity', 'domesticHotWater.electricity', 'manufacturer', 'price_zone'] ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Forecast generated: 24 predictions, min=3.68, max=4.01, avg=3.80 Wh ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Generated 24 predictions, total 91.10 Wh ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Publishing forecast summary for 21231500202609620933056238N3 to Pub/Sub ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Publishing to projects/YOUR_PROJECT/topics/intraday-forecasts: 235 bytes ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Published forecast summary: 24 predictions, 0.00 kWh total ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Generating 6h forecast for 21183900202529220938026983N5 starting 2025-02-28 01:00:00+00:00 ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
/Users/fedor/Documents/projects/CV/hometasks/podero/case2/temporal_app/activities/forecast_activities.py:225: FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
  historical_df = pd.read_json(historical_data_json, orient='records')
INFO:temporalio.activity:Historical data loaded: 672 rows, 10 columns: ['serial_number', 'start', 'end', 'start_unix', 'end_unix', 'centralHeating.electricity', 'cooling.electricity', 'domesticHotWater.electricity', 'manufacturer', 'price_zone'] ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Forecast generated: 24 predictions, min=65.48, max=68.70, avg=67.12 Wh ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Generated 24 predictions, total 1610.79 Wh ({'activity_id': '4', 'activity_type': 'generate_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Publishing forecast to trading system ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Storing audit log for workflow intraday-21231500202609620933056238N3-1767047421 ({'activity_id': '6', 'activity_type': 'store_audit_log', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Audit log: {
  "workflow_id": "intraday-21231500202609620933056238N3-1767047421",
  "device_id": "21231500202609620933056238N3",
  "forecast_start": "2025-02-28T01:00:00+00:00",
  "horizon_hours": 6,
  "requestor": "trading_system",
  "predictions_count": 24,
  "model_version": "v1.0",
  "created_at": "2025-12-29T22:30:22.209996+00:00"
} ({'activity_id': '6', 'activity_type': 'store_audit_log', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Publishing forecast summary for 21232200202609620933097655N9 to Pub/Sub ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Publishing to projects/YOUR_PROJECT/topics/intraday-forecasts: 266 bytes ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Published forecast summary: 24 predictions, 0.09 kWh total ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Publishing forecast to trading system ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Forecast completed in 788ms for device 21231500202609620933056238N3: 24 predictions, 0.00 kWh total ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78cd-9e31-2e8ee86c63b9', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21231500202609620933056238N3-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Publishing forecast summary for 21183900202529220938026983N5 to Pub/Sub ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Publishing to projects/YOUR_PROJECT/topics/intraday-forecasts: 262 bytes ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Published forecast summary: 24 predictions, 1.61 kWh total ({'activity_id': '5', 'activity_type': 'publish_forecast', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Storing audit log for workflow intraday-21232200202609620933097655N9-1767047421 ({'activity_id': '6', 'activity_type': 'store_audit_log', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Audit log: {
  "workflow_id": "intraday-21232200202609620933097655N9-1767047421",
  "device_id": "21232200202609620933097655N9",
  "forecast_start": "2025-02-28T01:00:00+00:00",
  "horizon_hours": 6,
  "requestor": "trading_system",
  "predictions_count": 24,
  "model_version": "v1.0",
  "created_at": "2025-12-29T22:30:22.232293+00:00"
} ({'activity_id': '6', 'activity_type': 'store_audit_log', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Forecast completed in 796ms for device 21232200202609620933097655N9: 24 predictions, 0.09 kWh total ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78a1-b1a6-d1cd5218e85c', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21232200202609620933097655N9-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Storing audit log for workflow intraday-21183900202529220938026983N5-1767047421 ({'activity_id': '6', 'activity_type': 'store_audit_log', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.activity:Audit log: {
  "workflow_id": "intraday-21183900202529220938026983N5-1767047421",
  "device_id": "21183900202529220938026983N5",
  "forecast_start": "2025-02-28T01:00:00+00:00",
  "horizon_hours": 6,
  "requestor": "trading_system",
  "predictions_count": 24,
  "model_version": "v1.0",
  "created_at": "2025-12-29T22:30:22.243858+00:00"
} ({'activity_id': '6', 'activity_type': 'store_audit_log', 'attempt': 1, 'namespace': 'default', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'workflow_type': 'IntradayForecastWorkflow'})
INFO:temporalio.workflow:Forecast completed in 804ms for device 21183900202529220938026983N5: 24 predictions, 1.61 kWh total ({'attempt': 1, 'namespace': 'default', 'run_id': '019b6c3b-de20-78f0-9cfd-8f0b408e8947', 'task_queue': 'forecast-queue', 'workflow_id': 'intraday-21183900202529220938026983N5-1767047421', 'workflow_type': 'IntradayForecastWorkflow'})
